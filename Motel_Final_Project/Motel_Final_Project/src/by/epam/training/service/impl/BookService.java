package by.epam.training.service.impl;import by.epam.training.dao.DAOException;import by.epam.training.dao.DAOFactory;import by.epam.training.dao.ReservationDAO;import by.epam.training.domain.Reservation;import by.epam.training.service.IService;import by.epam.training.service.ServiceException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.text.DateFormat;import java.text.ParseException;import java.text.SimpleDateFormat;import java.util.Date;import java.util.Locale;/** * Created by Михаил on 29.05.2016. */public class BookService implements IService {    private static final BookService instance = new BookService();    private static final String DATE_START="startDate";    private static final String DATE_END="endDate";    private static final String USER_ID="userID";    private static final String NUMBER_OF_GUESTS="guestNumber";    private static final String ROOM_ID="roomID";    private static final String PRICE="price";    private static final String ATTR_RESERVATION="reservation";    private static final String COD="SHA-1";    private static final String ERROR_MESSAGE="We have such reservation.";    public static BookService getInstance(){        return instance;    }    @Override    public void doService(HttpServletRequest request, HttpServletResponse response) throws ServiceException {        try {            System.out.println("====================[ BOOK ]=========================");            // read info from request            String startDate = request.getParameter(DATE_START);            String endDate = request.getParameter(DATE_END);            String userID = request.getParameter(USER_ID);            String guestNumber = request.getParameter(NUMBER_OF_GUESTS);            String roomID = request.getParameter(ROOM_ID);            String toDebit = request.getParameter(PRICE);            DAOFactory daoFactory = DAOFactory.getDAOFactory();            ReservationDAO reservationDAO = daoFactory.getReservationDAO();            boolean status = reservationDAO.checkReservation(startDate, endDate, userID, guestNumber, roomID);            if (!status) {                System.out.println("Reservation is free.");                Reservation reservation = null;                try {                    reservationDAO.createReservation(startDate, endDate, userID, guestNumber, roomID, toDebit);                    reservation = reservationDAO.getReservation(startDate, endDate, userID, guestNumber, roomID);                    request.getSession(true).setAttribute(ATTR_RESERVATION, reservation);                } catch (DAOException e) {                    throw new ServiceException(e);                }            } else {                System.out.println("We have such reservation.");                throw new ServiceException(ERROR_MESSAGE);            }    }//		catch (NoSuchAlgorithmException e) {//			throw new ServiceException(e);//		}        catch (DAOException e) {            throw new ServiceException(e);        }    }}